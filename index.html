<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDFãƒšãƒ¼ã‚¸ã‚·ãƒ£ãƒƒãƒ•ãƒ« | ç„¡æ–™ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒ„ãƒ¼ãƒ«</title>
    <meta name="description" content="PDFãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒšãƒ¼ã‚¸ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«ã‚·ãƒ£ãƒƒãƒ•ãƒ«ã§ãã‚‹ç„¡æ–™ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒ„ãƒ¼ãƒ«ã€‚ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ä¿è­·ã€è¡¨ç´™ãƒ»è£è¡¨ç´™ã®å›ºå®šã‚ªãƒ—ã‚·ãƒ§ãƒ³ä»˜ãã€‚ãƒ–ãƒ©ã‚¦ã‚¶ä¸Šã§å®Œçµã€‚">
    <meta name="keywords" content="PDF,ã‚·ãƒ£ãƒƒãƒ•ãƒ«,ãƒšãƒ¼ã‚¸,ãƒ©ãƒ³ãƒ€ãƒ ,ç„¡æ–™,ã‚ªãƒ³ãƒ©ã‚¤ãƒ³,ãƒ„ãƒ¼ãƒ«,ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼">
    <meta name="author" content="PDF Shuffle Tool">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://yourusername.github.io/pdf-shuffle/">
    <meta property="og:title" content="PDFãƒšãƒ¼ã‚¸ã‚·ãƒ£ãƒƒãƒ•ãƒ« | ç„¡æ–™ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒ„ãƒ¼ãƒ«">
    <meta property="og:description" content="PDFãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒšãƒ¼ã‚¸ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«ã‚·ãƒ£ãƒƒãƒ•ãƒ«ã§ãã‚‹ç„¡æ–™ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒ„ãƒ¼ãƒ«ã€‚ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ä¿è­·ã€è¡¨ç´™ãƒ»è£è¡¨ç´™ã®å›ºå®šã‚ªãƒ—ã‚·ãƒ§ãƒ³ä»˜ãã€‚">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://yourusername.github.io/pdf-shuffle/">
    <meta property="twitter:title" content="PDFãƒšãƒ¼ã‚¸ã‚·ãƒ£ãƒƒãƒ•ãƒ« | ç„¡æ–™ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒ„ãƒ¼ãƒ«">
    <meta property="twitter:description" content="PDFãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒšãƒ¼ã‚¸ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«ã‚·ãƒ£ãƒƒãƒ•ãƒ«ã§ãã‚‹ç„¡æ–™ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒ„ãƒ¼ãƒ«ã€‚ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ä¿è­·ã€è¡¨ç´™ãƒ»è£è¡¨ç´™ã®å›ºå®šã‚ªãƒ—ã‚·ãƒ§ãƒ³ä»˜ãã€‚">
    
    <link rel="canonical" href="https://tyama11.github.io/ShufflePDF/">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            font-size: 2.5rem;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .options-panel {
            background: rgba(102, 126, 234, 0.05);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            border: 2px solid rgba(102, 126, 234, 0.2);
        }

        .option-group {
            margin-bottom: 15px;
        }

        .option-group:last-child {
            margin-bottom: 0;
        }

        .switch-label {
            display: flex;
            align-items: center;
            cursor: pointer;
            font-size: 1.1rem;
            color: #333;
            font-weight: 500;
        }

        .switch-input {
            display: none;
        }

        .switch-slider {
            position: relative;
            width: 50px;
            height: 26px;
            background: #ccc;
            border-radius: 26px;
            transition: all 0.3s ease;
            margin-right: 15px;
        }

        .switch-slider::before {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            width: 22px;
            height: 22px;
            background: white;
            border-radius: 50%;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .switch-input:checked + .switch-slider {
            background: linear-gradient(135deg, #667eea, #764ba2);
        }

        .switch-input:checked + .switch-slider::before {
            transform: translateX(24px);
        }

        .switch-text {
            user-select: none;
        }

        .upload-area {
            border: 3px dashed #667eea;
            border-radius: 15px;
            padding: 60px 20px;
            text-align: center;
            background: rgba(102, 126, 234, 0.05);
            transition: all 0.3s ease;
            cursor: pointer;
            margin-bottom: 30px;
        }

        .upload-area:hover {
            border-color: #764ba2;
            background: rgba(118, 75, 162, 0.1);
            transform: translateY(-2px);
        }

        .upload-area.dragover {
            border-color: #764ba2;
            background: rgba(118, 75, 162, 0.15);
            transform: scale(1.02);
        }

        .upload-icon {
            font-size: 4rem;
            color: #667eea;
            margin-bottom: 20px;
        }

        .upload-text {
            color: #666;
            font-size: 1.2rem;
            margin-bottom: 15px;
        }

        .file-input {
            display: none;
        }

        .btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-block;
            text-decoration: none;
            margin: 10px;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .btn-secondary {
            background: linear-gradient(135deg, #28a745, #20c997);
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.3);
        }

        .btn-secondary:hover {
            box-shadow: 0 8px 25px rgba(40, 167, 69, 0.4);
        }

        .status {
            margin: 20px 0;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            font-weight: bold;
        }

        .status.info {
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
            border: 2px solid rgba(102, 126, 234, 0.3);
        }

        .status.success {
            background: rgba(40, 167, 69, 0.1);
            color: #28a745;
            border: 2px solid rgba(40, 167, 69, 0.3);
        }

        .status.error {
            background: rgba(220, 53, 69, 0.1);
            color: #dc3545;
            border: 2px solid rgba(220, 53, 69, 0.3);
        }

        .controls {
            text-align: center;
            margin: 30px 0;
        }

        .loading {
            display: none;
            text-align: center;
            margin: 20px 0;
        }

        .spinner {
            border: 4px solid rgba(102, 126, 234, 0.1);
            border-left: 4px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .page-info {
            background: rgba(102, 126, 234, 0.05);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }

        .features {
            margin-top: 40px;
            text-align: center;
        }

        .features h2 {
            color: #333;
            margin-bottom: 20px;
        }

        .description {
            background: rgba(102, 126, 234, 0.05);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 25px;
            line-height: 1.6;
        }

        .description p {
            color: #555;
            font-size: 1rem;
            text-align: left;
            margin: 0;
        }

        .feature-list {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 20px;
        }

        .feature {
            background: rgba(102, 126, 234, 0.1);
            padding: 15px 20px;
            border-radius: 10px;
            color: #667eea;
            font-weight: bold;
        }

        .share-section {
            margin: 40px 0;
            text-align: center;
            padding: 25px;
            background: rgba(102, 126, 234, 0.05);
            border-radius: 15px;
            border: 2px solid rgba(102, 126, 234, 0.2);
        }

        .share-section h3 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.3rem;
        }

        .share-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .share-btn {
            display: inline-flex;
            align-items: center;
            padding: 12px 20px;
            border: none;
            border-radius: 50px;
            color: white;
            text-decoration: none;
            font-size: 0.95rem;
            font-weight: 600;
            transition: all 0.3s ease;
            cursor: pointer;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
        }

        .share-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .share-btn svg {
            width: 18px;
            height: 18px;
            margin-right: 8px;
        }

        .share-btn.twitter {
            background: linear-gradient(135deg, #1da1f2, #0d8bd9);
        }

        .share-btn.facebook {
            background: linear-gradient(135deg, #4267b2, #365899);
        }

        .share-btn.line {
            background: linear-gradient(135deg, #00c300, #00a000);
        }

        .share-btn.linkedin {
            background: linear-gradient(135deg, #0077b5, #005885);
        }

        .share-btn.copy {
            background: linear-gradient(135deg, #6c757d, #545b62);
        }

        .share-btn.copy.copied {
            background: linear-gradient(135deg, #28a745, #1e7e34);
        }

        .footer {
            margin-top: 50px;
            text-align: center;
            color: #666;
            font-size: 0.9rem;
            padding: 20px;
            border-top: 1px solid rgba(102, 126, 234, 0.2);
        }

        .footer a {
            color: #667eea;
            text-decoration: none;
        }

        .footer a:hover {
            text-decoration: underline;
        }

        /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ */
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }

            h1 {
                font-size: 2rem;
            }

            .upload-area {
                padding: 40px 15px;
            }

            .upload-icon {
                font-size: 3rem;
            }

            .feature-list {
                flex-direction: column;
                align-items: center;
            }

            .feature {
                width: 100%;
                max-width: 300px;
            }

            .share-buttons {
                flex-direction: column;
                align-items: center;
            }

            .share-btn {
                width: 100%;
                max-width: 250px;
                justify-content: center;
            }
        }

        /* ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£å¯¾å¿œ */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        /* ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰å¯¾å¿œ */
        @media (prefers-color-scheme: dark) {
            body {
                background: linear-gradient(135deg, #2d3748 0%, #4a5568 100%);
            }

            .container {
                background: rgba(45, 55, 72, 0.95);
                color: #e2e8f0;
            }

            h1 {
                color: #e2e8f0;
            }

            .upload-text, .description p {
                color: #cbd5e0;
            }

            .switch-text {
                color: #e2e8f0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ“„ PDFãƒšãƒ¼ã‚¸ã‚·ãƒ£ãƒƒãƒ•ãƒ«</h1>
        </header>

        <main>
            <section class="options-panel">
                <div class="option-group">
                    <label class="switch-label">
                        <input type="checkbox" id="preserveFirstPage" class="switch-input">
                        <span class="switch-slider"></span>
                        <span class="switch-text">æœ€åˆã®ãƒšãƒ¼ã‚¸ã‚’å›ºå®š</span>
                    </label>
                </div>
                <div class="option-group">
                    <label class="switch-label">
                        <input type="checkbox" id="preserveLastPage" class="switch-input">
                        <span class="switch-slider"></span>
                        <span class="switch-text">æœ€å¾Œã®ãƒšãƒ¼ã‚¸ã‚’å›ºå®š</span>
                    </label>
                </div>
            </section>

            <section class="upload-area" id="uploadArea">
                <div class="upload-icon">ğŸ“</div>
                <div class="upload-text">PDFãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã“ã“ã«ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—</div>
                <div class="upload-text">ã¾ãŸã¯</div>
                <button class="btn" onclick="document.getElementById('fileInput').click()">
                    ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ
                </button>
                <input type="file" id="fileInput" class="file-input" accept=".pdf">
            </section>

            <div id="status" class="status" style="display: none;"></div>
            
            <div class="loading" id="loading">
                <div class="spinner"></div>
                <div>PDFã‚’å‡¦ç†ä¸­...</div>
            </div>

            <div id="pageInfo" class="page-info" style="display: none;">
                <h3>ğŸ“‹ PDFæƒ…å ±</h3>
                <div id="pageCount"></div>
            </div>

            <div class="controls">
                <button class="btn" id="shuffleBtn" onclick="shufflePDF()" disabled>
                    ğŸ”€ ãƒšãƒ¼ã‚¸ã‚’ã‚·ãƒ£ãƒƒãƒ•ãƒ«
                </button>
                <button class="btn btn-secondary" id="downloadBtn" onclick="downloadShuffledPDF()" disabled style="display: none;">
                    ğŸ’¾ ã‚·ãƒ£ãƒƒãƒ•ãƒ«æ¸ˆã¿PDFã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
                </button>
            </div>

            <section class="features">
                <h2>âœ¨ æ©Ÿèƒ½</h2>
                <div class="description">
                    <p>ã“ã®PDFãƒšãƒ¼ã‚¸ã‚·ãƒ£ãƒƒãƒ•ãƒ«ãƒ„ãƒ¼ãƒ«ã¯ã€PDFãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒšãƒ¼ã‚¸ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«ä¸¦ã³æ›¿ãˆã‚‹ã“ã¨ãŒã§ãã‚‹Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚ãƒ–ãƒ©ã‚¦ã‚¶ä¸Šã§å®Œçµã™ã‚‹ãŸã‚ã€ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡ã•ã‚Œã‚‹ã“ã¨ãªãã€ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãŒå®Œå…¨ã«ä¿è­·ã•ã‚Œã¾ã™ã€‚è¡¨ç´™ã‚„è£è¡¨ç´™ãªã©ã€ä½ç½®ã‚’å¤‰ãˆãŸããªã„ãƒšãƒ¼ã‚¸ã¯å›ºå®šã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ä¿è­·ã§ãã¾ã™ã€‚å‡¦ç†å¾Œã¯å³åº§ã«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãŒå¯èƒ½ã§ã€å…ƒã®ãƒ•ã‚¡ã‚¤ãƒ«åã«ã€Œ_shuffledã€ãŒä»˜åŠ ã•ã‚Œã¾ã™ã€‚</p>
                </div>
                <div class="feature-list">
                    <div class="feature">ğŸ”€ ãƒ©ãƒ³ãƒ€ãƒ ã‚·ãƒ£ãƒƒãƒ•ãƒ«</div>
                    <div class="feature">ğŸ“Œ ãƒšãƒ¼ã‚¸å›ºå®šã‚ªãƒ—ã‚·ãƒ§ãƒ³</div>
                    <div class="feature">ğŸ“„ å…¨ãƒšãƒ¼ã‚¸å¯¾å¿œ</div>
                    <div class="feature">ğŸ’¾ å³åº§ã«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</div>
                    <div class="feature">ğŸ”’ ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ä¿è­·</div>
                </div>
            </section>

            <section class="share-section">
                <h3>ğŸ“¢ ã“ã®ãƒ„ãƒ¼ãƒ«ã‚’ã‚·ã‚§ã‚¢</h3>
                <div class="share-buttons">
                    <button class="share-btn twitter" onclick="shareToTwitter()">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"/>
                        </svg>
                        X ã§ã‚·ã‚§ã‚¢
                    </button>
                    <button class="share-btn facebook" onclick="shareToFacebook()">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                        </svg>
                        Facebook ã§ã‚·ã‚§ã‚¢
                    </button>
                    <button class="share-btn line" onclick="shareToLine()">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zm4.889 8.889c0 .146-.146.292-.292.292H8.403c-.146 0-.292-.146-.292-.292V9.111c0-.146.146-.292.292-.292h8.194c.146 0 .292.146.292.292v1.778zm0 3.556c0 .146-.146.292-.292.292H8.403c-.146 0-.292-.146-.292-.292v-1.778c0-.146.146-.292.292-.292h8.194c.146 0 .292.146.292.292v1.778z"/>
                        </svg>
                        LINE ã§ã‚·ã‚§ã‚¢
                    </button>
                    <button class="share-btn linkedin" onclick="shareToLinkedIn()">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                        </svg>
                        LinkedIn ã§ã‚·ã‚§ã‚¢
                    </button>
                    <button class="share-btn copy" onclick="copyLink()" id="copyBtn">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/>
                        </svg>
                        ãƒªãƒ³ã‚¯ã‚’ã‚³ãƒ”ãƒ¼
                    </button>
                </div>
            </section>
        </main>

        <footer class="footer">
            <p>&copy; 2025 PDF Shuffle Tool. ãƒ–ãƒ©ã‚¦ã‚¶ä¸Šã§å‹•ä½œã™ã‚‹ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚</p>
            <p>æ©Ÿèƒ½è¿½åŠ ã‚„ä¸å…·åˆãŒã‚ã‚Œã° <a href="https://github.com/tyama11/ShufflePDF" target="_blank" rel="noopener">GitHub</a> ã«ãŠçŸ¥ã‚‰ã›ãã ã•ã„ã€‚</p>
        </footer>
    </div>

    <script>
        let originalPdfBytes = null;
        let shuffledPdfBytes = null;
        let originalFileName = '';

        // ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—æ©Ÿèƒ½
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        const status = document.getElementById('status');
        const loading = document.getElementById('loading');
        const pageInfo = document.getElementById('pageInfo');
        const shuffleBtn = document.getElementById('shuffleBtn');
        const downloadBtn = document.getElementById('downloadBtn');

        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®è¨­å®š
        uploadArea.addEventListener('dragover', handleDragOver);
        uploadArea.addEventListener('dragleave', handleDragLeave);
        uploadArea.addEventListener('drop', handleDrop);
        fileInput.addEventListener('change', handleFileInput);

        function handleDragOver(e) {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        }

        function handleDragLeave() {
            uploadArea.classList.remove('dragover');
        }

        function handleDrop(e) {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                handleFile(files[0]);
            }
        }

        function handleFileInput(e) {
            if (e.target.files.length > 0) {
                handleFile(e.target.files[0]);
            }
        }

        function showStatus(message, type) {
            status.textContent = message;
            status.className = `status ${type}`;
            status.style.display = 'block';
        }

        function hideStatus() {
            status.style.display = 'none';
        }

        function showLoading(show = true) {
            loading.style.display = show ? 'block' : 'none';
        }

        async function handleFile(file) {
            if (file.type !== 'application/pdf') {
                showStatus('PDFãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚', 'error');
                return;
            }

            originalFileName = file.name;
            showLoading(true);
            hideStatus();

            try {
                const arrayBuffer = await file.arrayBuffer();
                originalPdfBytes = new Uint8Array(arrayBuffer);
                
                // PDFæƒ…å ±ã‚’å–å¾—
                const pdfDoc = await PDFLib.PDFDocument.load(originalPdfBytes);
                const pageCount = pdfDoc.getPageCount();
                
                document.getElementById('pageCount').textContent = `ç·ãƒšãƒ¼ã‚¸æ•°: ${pageCount}ãƒšãƒ¼ã‚¸`;
                pageInfo.style.display = 'block';
                shuffleBtn.disabled = false;
                downloadBtn.style.display = 'none';
                shuffledPdfBytes = null;
                
                showStatus(`PDFãƒ•ã‚¡ã‚¤ãƒ« "${file.name}" ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸï¼`, 'success');
            } catch (error) {
                console.error('PDFèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
                showStatus('PDFãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ç ´æã—ã¦ã„ãªã„ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚', 'error');
            } finally {
                showLoading(false);
            }
        }

        async function shufflePDF() {
            if (!originalPdfBytes) {
                showStatus('ã¾ãšPDFãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚', 'error');
                return;
            }

            showLoading(true);
            shuffleBtn.disabled = true;
            hideStatus();

            try {
                // å…ƒã®PDFã‚’èª­ã¿è¾¼ã¿
                const originalDoc = await PDFLib.PDFDocument.load(originalPdfBytes);
                const pageCount = originalDoc.getPageCount();
                
                if (pageCount === 0) {
                    showStatus('PDFã«ãƒšãƒ¼ã‚¸ãŒå«ã¾ã‚Œã¦ã„ã¾ã›ã‚“ã€‚', 'error');
                    return;
                }
                
                // æ–°ã—ã„PDFãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ä½œæˆ
                const newDoc = await PDFLib.PDFDocument.create();
                
                // ã‚ªãƒ—ã‚·ãƒ§ãƒ³è¨­å®šã‚’å–å¾—
                const preserveFirst = document.getElementById('preserveFirstPage').checked;
                const preserveLast = document.getElementById('preserveLastPage').checked;
                
                // ã‚·ãƒ£ãƒƒãƒ•ãƒ«å¯¾è±¡ã®ãƒšãƒ¼ã‚¸ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’æ±ºå®š
                let startIndex = preserveFirst ? 1 : 0;
                let endIndex = preserveLast ? pageCount - 1 : pageCount;
                
                // å…¨ãƒšãƒ¼ã‚¸ãŒå›ºå®šã•ã‚Œã¦ã„ã‚‹å ´åˆã®å‡¦ç†
                if (startIndex >= endIndex) {
                    // å…¨ãƒšãƒ¼ã‚¸ã‚’ãã®ã¾ã¾ã‚³ãƒ”ãƒ¼
                    for (let i = 0; i < pageCount; i++) {
                        const [copiedPage] = await newDoc.copyPages(originalDoc, [i]);
                        newDoc.addPage(copiedPage);
                    }
                    showStatus('å…¨ã¦ã®ãƒšãƒ¼ã‚¸ãŒå›ºå®šã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€é †åºã¯å¤‰æ›´ã•ã‚Œã¾ã›ã‚“ã§ã—ãŸã€‚', 'info');
                } else {
                    // ã‚·ãƒ£ãƒƒãƒ•ãƒ«å¯¾è±¡ã®ãƒšãƒ¼ã‚¸ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹é…åˆ—ã‚’ä½œæˆ
                    const shuffleIndices = [];
                    for (let i = startIndex; i < endIndex; i++) {
                        shuffleIndices.push(i);
                    }
                    
                    // ã‚·ãƒ£ãƒƒãƒ•ãƒ«å¯¾è±¡ã®ãƒšãƒ¼ã‚¸ã‚’ã‚·ãƒ£ãƒƒãƒ•ãƒ«
                    shuffleArray(shuffleIndices);
                    
                    // æœ€åˆã®ãƒšãƒ¼ã‚¸ã‚’è¿½åŠ ï¼ˆå›ºå®šã®å ´åˆï¼‰
                    if (preserveFirst && pageCount > 0) {
                        const [firstPage] = await newDoc.copyPages(originalDoc, [0]);
                        newDoc.addPage(firstPage);
                    }
                    
                    // ã‚·ãƒ£ãƒƒãƒ•ãƒ«ã•ã‚ŒãŸä¸­é–“ãƒšãƒ¼ã‚¸ã‚’è¿½åŠ 
                    for (const pageIndex of shuffleIndices) {
                        const [copiedPage] = await newDoc.copyPages(originalDoc, [pageIndex]);
                        newDoc.addPage(copiedPage);
                    }
                    
                    // æœ€å¾Œã®ãƒšãƒ¼ã‚¸ã‚’è¿½åŠ ï¼ˆå›ºå®šã®å ´åˆï¼‰
                    if (preserveLast && pageCount > 0) {
                        const [lastPage] = await newDoc.copyPages(originalDoc, [pageCount - 1]);
                        newDoc.addPage(lastPage);
                    }
                    
                    let shuffledCount = shuffleIndices.length;
                    let message = `${shuffledCount}ãƒšãƒ¼ã‚¸ã‚’ã‚·ãƒ£ãƒƒãƒ•ãƒ«ã—ã¾ã—ãŸï¼`;
                    
                    if (preserveFirst || preserveLast) {
                        let fixedPages = [];
                        if (preserveFirst) fixedPages.push('æœ€åˆã®ãƒšãƒ¼ã‚¸');
                        if (preserveLast) fixedPages.push('æœ€å¾Œã®ãƒšãƒ¼ã‚¸');
                        message += ` (${fixedPages.join('ã¨')}ã¯å›ºå®š)`;
                    }
                    
                    showStatus(message, 'success');
                }
                
                // PDFã‚’ãƒã‚¤ãƒˆé…åˆ—ã«å¤‰æ›
                shuffledPdfBytes = await newDoc.save();
                downloadBtn.disabled = false;
                downloadBtn.style.display = 'inline-block';
                
            } catch (error) {
                console.error('ã‚·ãƒ£ãƒƒãƒ•ãƒ«ã‚¨ãƒ©ãƒ¼:', error);
                showStatus('PDFã®ã‚·ãƒ£ãƒƒãƒ•ãƒ«ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ãƒ•ã‚¡ã‚¤ãƒ«ãŒç ´æã—ã¦ã„ãªã„ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚', 'error');
            } finally {
                showLoading(false);
                shuffleBtn.disabled = false;
            }
        }

        function shuffleArray(array) {
            // Fisher-Yates ã‚·ãƒ£ãƒƒãƒ•ãƒ«ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        function downloadShuffledPDF() {
            if (!shuffledPdfBytes) {
                showStatus('ã¾ãšPDFã‚’ã‚·ãƒ£ãƒƒãƒ•ãƒ«ã—ã¦ãã ã•ã„ã€‚', 'error');
                return;
            }

            try {
                const blob = new Blob([shuffledPdfBytes], { type: 'application/pdf' });
                const url = URL.createObjectURL(blob);
                
                const a = document.createElement('a');
                a.href = url;
                const baseName = originalFileName.replace(/\.pdf$/i, '');
                a.download = `${baseName}_shuffled.pdf`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                showStatus('ã‚·ãƒ£ãƒƒãƒ•ãƒ«æ¸ˆã¿PDFã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã—ãŸï¼', 'success');
            } catch (error) {
                console.error('ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚¨ãƒ©ãƒ¼:', error);
                showStatus('ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸã€‚', 'error');
            }
        }

        // ã‚½ãƒ¼ã‚·ãƒ£ãƒ«ãƒ¡ãƒ‡ã‚£ã‚¢å…±æœ‰æ©Ÿèƒ½
        function shareToTwitter() {
            const url = encodeURIComponent(window.location.href);
            const text = encodeURIComponent('PDFãƒšãƒ¼ã‚¸ã‚·ãƒ£ãƒƒãƒ•ãƒ« - PDFãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒšãƒ¼ã‚¸ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«ä¸¦ã³æ›¿ãˆã§ãã‚‹ç„¡æ–™ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒ„ãƒ¼ãƒ«ï¼ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ä¿è­·ã§å®‰å¿ƒã§ã™ã€‚');
            const hashtags = encodeURIComponent('PDF,ã‚·ãƒ£ãƒƒãƒ•ãƒ«,ç„¡æ–™ãƒ„ãƒ¼ãƒ«,ã‚ªãƒ³ãƒ©ã‚¤ãƒ³');
            
            const twitterUrl = `https://twitter.com/intent/tweet?url=${url}&text=${text}&hashtags=${hashtags}`;
            window.open(twitterUrl, '_blank', 'width=550,height=420');
        }

        function shareToFacebook() {
            const url = encodeURIComponent(window.location.href);
            const facebookUrl = `https://www.facebook.com/sharer/sharer.php?u=${url}`;
            window.open(facebookUrl, '_blank', 'width=580,height=296');
        }

        function shareToLine() {
            const url = encodeURIComponent(window.location.href);
            const text = encodeURIComponent('PDFãƒšãƒ¼ã‚¸ã‚·ãƒ£ãƒƒãƒ•ãƒ« - PDFãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒšãƒ¼ã‚¸ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«ä¸¦ã³æ›¿ãˆã§ãã‚‹ç„¡æ–™ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒ„ãƒ¼ãƒ«ï¼');
            
            const lineUrl = `https://social-plugins.line.me/lineit/share?url=${url}&text=${text}`;
            window.open(lineUrl, '_blank');
        }

        function shareToLinkedIn() {
            const url = encodeURIComponent(window.location.href);
            const title = encodeURIComponent('PDFãƒšãƒ¼ã‚¸ã‚·ãƒ£ãƒƒãƒ•ãƒ« | ç„¡æ–™ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒ„ãƒ¼ãƒ«');
            const summary = encodeURIComponent('PDFãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒšãƒ¼ã‚¸ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«ã‚·ãƒ£ãƒƒãƒ•ãƒ«ã§ãã‚‹ç„¡æ–™ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒ„ãƒ¼ãƒ«ã€‚ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ä¿è­·ã€è¡¨ç´™ãƒ»è£è¡¨ç´™ã®å›ºå®šã‚ªãƒ—ã‚·ãƒ§ãƒ³ä»˜ãã€‚');
            
            const linkedinUrl = `https://www.linkedin.com/sharing/share-offsite/?url=${url}&title=${title}&summary=${summary}`;
            window.open(linkedinUrl, '_blank');
        }

        function copyLink() {
            const copyBtn = document.getElementById('copyBtn');
            const url = window.location.href;
            
            if (navigator.clipboard && window.isSecureContext) {
                // ãƒ¢ãƒ€ãƒ³ãƒ–ãƒ©ã‚¦ã‚¶å¯¾å¿œ
                navigator.clipboard.writeText(url).then(() => {
                    showCopySuccess();
                }).catch(() => {
                    fallbackCopyTextToClipboard(url);
                });
            } else {
                // å¤ã„ãƒ–ãƒ©ã‚¦ã‚¶å¯¾å¿œ
                fallbackCopyTextToClipboard(url);
            }
        }

        function fallbackCopyTextToClipboard(text) {
            const textArea = document.createElement("textarea");
            textArea.value = text;
            
            // ç”»é¢å¤–ã«é…ç½®
            textArea.style.position = "fixed";
            textArea.style.left = "-999999px";
            textArea.style.top = "-999999px";
            document.body.appendChild(textArea);
            
            textArea.focus();
            textArea.select();
            
            try {
                const successful = document.execCommand('copy');
                if (successful) {
                    showCopySuccess();
                } else {
                    showStatus('ãƒªãƒ³ã‚¯ã®ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸã€‚', 'error');
                }
            } catch (err) {
                showStatus('ãƒªãƒ³ã‚¯ã®ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸã€‚', 'error');
            }
            
            document.body.removeChild(textArea);
        }

        function showCopySuccess() {
            const copyBtn = document.getElementById('copyBtn');
            const originalText = copyBtn.innerHTML;
            
            copyBtn.classList.add('copied');
            copyBtn.innerHTML = `
                <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"/>
                </svg>
                ã‚³ãƒ”ãƒ¼å®Œäº†ï¼
            `;
            
            showStatus('ãƒªãƒ³ã‚¯ã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼', 'success');
            
            setTimeout(() => {
                copyBtn.classList.remove('copied');
                copyBtn.innerHTML = originalText;
            }, 2000);
        }


    </script>
</body>
</html>
